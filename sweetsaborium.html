<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Sweet Saborium â€” Sweet</title>

  <!-- Montserrat -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* ===== FONT LOGO ===== */
    @font-face {
      font-family: "BogartTrial";
      src: url("fuente_saborium.ttf") format("truetype");
      font-weight: 900;
      font-style: italic;
      font-display: swap;
    }

    /* ===== RESET & BASE ===== */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html,body { height:100%; font-family: "Montserrat", sans-serif; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; background: linear-gradient(180deg,#fff7fb 0%, #fff3f6 100%); color:#111; }
    a { color: inherit; text-decoration:none; }

    /* ===== COLORS / THEME ===== */
    :root{
      --pink:#ffd8e0;
      --pink-strong:#ffbfce;
      --accent:#d4af37;
      --card-bg: rgba(255,255,255,0.9);
      --muted:#8b6f78;
      --shadow: 0 8px 30px rgba(15,10,12,0.06);
    }

    /* ===== HEADER / LOGO ===== */
    header {
      position: sticky;
      top:0;
      z-index:60;
      background: linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.5));
      border-bottom: 1px solid rgba(0,0,0,0.04);
      backdrop-filter: blur(6px);
    }
    .topbar {
      max-width:1200px; margin:0 auto; padding:12px 20px; display:flex; justify-content:space-between; align-items:center;
    }
    .brand {
      display:flex; flex-direction:column; gap:2px;
    }
    .brand .logo {
      font-family:"BogartTrial", serif; color: #ff9fb3; font-size:32px; font-weight:900; font-style:italic; letter-spacing:1px; text-transform:lowercase;
    }
    .brand .by {
      font-size:12px; background:#000; color:#fff; padding:3px 8px; border-radius:8px; margin-top:2px; display:inline-block; font-weight:600;
    }

    /* ===== HOMEPANE - GABITY ===== */
    .cover {
      height:100vh; width:100%;
      display:flex; align-items:center; justify-content:center;
      background: radial-gradient(circle at 10% 10%, #fff0 0%, #fff0 40%), linear-gradient(180deg, #fff3f8 0%, #fff0 100%);
      position:relative; overflow:hidden;
    }
    .cover .center {
      text-align:center; padding:40px; max-width:980px;
      transform-origin:center;
    }
    .cover h1 {
      font-size:44px; color:#1b1b1b; margin-bottom:8px; letter-spacing:0.6px;
    }
    .cover p { color:#6b4f56; margin-bottom:18px; font-size:18px; }
    .enter-btn {
      display:inline-block; background: linear-gradient(180deg,var(--pink),var(--pink-strong));
      color:#071018; padding:14px 26px; border-radius:999px; font-weight:700; box-shadow: var(--shadow);
      border: none; cursor:pointer; transition: transform .24s ease, box-shadow .24s ease;
      font-size:16px;
    }
    .enter-btn:hover { transform: translateY(-4px); box-shadow: 0 14px 36px rgba(15,10,12,0.08); }

    /* subtle sugar texture */
    .cover::after {
      content:"";
      position:absolute; inset:0;
      background-image: radial-gradient(circle, rgba(255,255,255,0.18) 1px, transparent 1px);
      background-size: 18px 18px; opacity:0.12; mix-blend-mode: overlay;
      pointer-events:none;
    }

    /* ===== MAIN LAYOUT ===== */
    main { max-width:1200px; margin:32px auto; padding:20px; display:flex; gap:28px; align-items:flex-start; }
    .content { flex:1; }
    aside.sidebar { width:340px; flex-shrink:0; position:sticky; top:110px; align-self:flex-start; }

    /* ===== NEWS BAR (small, only Gabity removed from inner) ===== */
    .news-banner {
      display:flex; align-items:center; justify-content:center; gap:12px;
      margin-bottom:18px; padding:12px; background: linear-gradient(90deg, rgba(255,220,230,0.6), rgba(255,245,247,0.5));
      border-radius: 14px; border:1px solid rgba(0,0,0,0.03);
      box-shadow: var(--shadow);
    }
    .news-banner strong { font-weight:700; color:#9b5a67; }

    /* ===== GRID DE PRODUCTOS ===== */
    .grid {
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap:22px;
    }
    .card {
      background: var(--card-bg);
      border-radius:16px;
      padding:16px;
      display:flex;
      gap:16px;
      align-items:flex-start;
      box-shadow: var(--shadow);
      transition: transform .22s ease, box-shadow .22s ease;
    }
    .card:hover { transform: translateY(-6px); box-shadow: 0 20px 40px rgba(20,15,18,0.06); }
    .thumb {
      width: 360px; height: 240px; flex-shrink:0; border-radius:12px; overflow:hidden; background:#f0e8ea;
      display:flex; align-items:center; justify-content:center;
    }
    .thumb img { width:100%; height:100%; object-fit:cover; display:block; }

    .meta { flex:1; min-width:0; display:flex; flex-direction:column; gap:8px; }
    .meta h3 { font-size:20px; color:#111; }
    .meta p { color:var(--muted); font-size:14px; line-height:1.4; }
    .meta .price { font-weight:700; color:#b45f6a; margin-top:8px; }

    .actions { display:flex; gap:10px; margin-top:8px; flex-wrap:wrap; }
    .btn {
      padding:10px 14px; border-radius:12px; border:none; cursor:pointer; font-weight:600;
      background:rgba(0,0,0,0.04); color:#111;
    }
    .btn.ghost { background:transparent; border:1px solid rgba(0,0,0,0.06); }
    .btn.primary {
      background: linear-gradient(180deg,#ffd9e3,#ffc9d6);
      color:#071018;
      box-shadow: 0 6px 20px rgba(0,0,0,0.06);
    }

    /* ===== SIDEBAR: CESTA ===== */
    .sidebar .card {
      display:block;
      padding:14px;
      border-radius:14px;
    }
    .cart-header { display:flex; align-items:center; justify-content:space-between; gap:8px; }
    .cart-list { margin-top:12px; display:flex; flex-direction:column; gap:10px; max-height:360px; overflow:auto; padding-right:6px; }
    .cart-item { display:flex; justify-content:space-between; align-items:center; gap:10px; padding:10px; border-radius:10px; background:linear-gradient(180deg,#fff,#fff); border:1px solid rgba(0,0,0,0.03); }
    .cart-item .info { min-width:0; }
    .cart-item .info .name { font-weight:700; color:#222; font-size:14px; }
    .cart-item .controls { display:flex; gap:6px; align-items:center; }
    .small-btn { padding:6px 8px; border-radius:8px; background:transparent; border:1px solid rgba(0,0,0,0.06); cursor:pointer; }

    .total-row { margin-top:12px; display:flex; justify-content:space-between; align-items:center; font-weight:700; color:#222; font-size:16px; }

    .checkout-buttons { margin-top:14px; display:flex; gap:10px; }

    /* ===== FORM MODAL (checkout) ===== */
    .overlay { position:fixed; inset:0; background: rgba(10,7,9,0.6); display:none; align-items:center; justify-content:center; z-index:120; padding:18px; }
    .overlay.active { display:flex; }
    .modal {
      width: min(880px, 96%); max-height:92vh; overflow:auto; border-radius:14px; background: #fff; padding:18px; box-shadow: 0 30px 80px rgba(10,6,8,0.5);
      display:grid; grid-template-columns: 1fr 1fr; gap:16px;
    }
    .modal .photo { border-radius:10px; overflow:hidden; height:100%; }
    .modal img { width:100%; height:100%; object-fit:cover; display:block; }
    .modal .info h3 { margin-bottom:8px; color:#111; }
    .modal .info p { color:#4c3a3e; }

    /* Close button improved */
    .close-x {
      position:absolute; right:12px; top:12px; width:40px; height:40px; border-radius:999px; display:flex; align-items:center; justify-content:center;
      background: rgba(0,0,0,0.6); color:#fff; cursor:pointer; font-weight:800; box-shadow: 0 6px 20px rgba(0,0,0,0.25);
    }

    /* ===== CHECKOUT FORM MODAL ===== */
    .form-modal { width:520px; max-width:96%; padding:18px; border-radius:12px; background:var(--card-bg); box-shadow:var(--shadow); }
    .form-modal h4 { margin-bottom:8px; font-size:18px; }
    .form-row { display:flex; gap:8px; margin-top:8px; }
    .form-row .col { flex:1; display:flex; flex-direction:column; gap:8px; }
    input[type="text"], input[type="email"], input[type="tel"], textarea, select {
      padding:10px 12px; border-radius:8px; border:1px solid rgba(0,0,0,0.06); font-family:"Montserrat",sans-serif;
      font-size:14px; outline:none;
    }
    textarea { resize:vertical; min-height:64px; }

    /* Address animation */
    .address-field { max-height:0; opacity:0; transform:translateY(-6px); overflow:hidden; transition: all .36s cubic-bezier(.2,.9,.2,1); }
    .address-field.open { max-height:120px; opacity:1; transform:translateY(0); padding-top:8px; }

    /* RESPONSIVE */
    @media (max-width: 980px) {
      main { flex-direction:column; padding:14px; }
      aside.sidebar { width:100%; position:static; top:auto; }
      .modal { grid-template-columns: 1fr; }
      .thumb { width:100%; height:200px; }
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header>
    <div class="topbar">
      <div class="brand" aria-hidden="true">
        <div class="logo">sweet saborium</div>
        <div class="by">by saborium.</div>
      </div>

      <div style="display:flex;align-items:center;gap:12px;">
        <div style="font-weight:700;color:#9b5a67;">Sweet Â· Premium</div>
        <button id="openCartBtn" class="btn ghost" onclick="toggleCart()">ðŸ§º Cesta (<span id="cartCount">0</span>)</button>
      </div>
    </div>
  </header>

  <!-- COVER (Gabity) -->
  <section class="cover" id="cover">
    <div class="center" role="region" aria-label="Anuncio temporada Gabity">
      <h1>Temporada Sweet Saborium â€” EdiciÃ³n Navidad</h1>
      <p>En colaboraciÃ³n con <strong>Gabity</strong>. Apertura: <strong>1 de diciembre</strong>. Â¡Haz tu reserva!</p>
      <button class="enter-btn" id="enterBtn">Entrar</button>
    </div>
  </section>

  <!-- MAIN -->
  <main id="mainContent" style="opacity:0; transform: translateY(12px); transition: all .6s cubic-bezier(.2,.9,.2,1);">
    <div class="content">
      <div class="news-banner">
        <div style="font-weight:700;color:#7a4950">Temporada Navidad Â· Gabity Â· Reservas desde 1 de diciembre</div>
      </div>

      <!-- GRID PRODUCTS -->
      <section class="grid" id="productsGrid" aria-live="polite">

        <!-- Nuestra Tarta (producto estrella) -->
        <article class="card" data-id="p1" data-name="Nuestra Tarta">
          <div class="thumb">
            <img src="https://via.placeholder.com/1200x800.png?text=Nuestra+Tarta" alt="Nuestra Tarta">
          </div>
          <div class="meta">
            <h3>Nuestra Tarta</h3>
            <p>La original de Sweet Saborium: cremosa por dentro, ligeramente tostada por fuera. Nuestro producto estrella con receta de arrancada.</p>
            <div class="price">0.00 â‚¬</div>
            <div class="actions">
              <button class="btn primary" onclick="addToCart('p1')">AÃ±adir a la cesta</button>
              <button class="btn ghost" onclick="openProductModal('p1')">Ver mÃ¡s</button>
            </div>
          </div>
        </article>

        <!-- Lorem Ipsum products -->
        <article class="card" data-id="p2" data-name="Lorem Ipsum">
          <div class="thumb"><img src="https://via.placeholder.com/1200x800.png?text=Lorem+Ipsum+1" alt="Lorem Ipsum"></div>
          <div class="meta">
            <h3>Lorem Ipsum</h3>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut a urna non ipsum gravida.</p>
            <div class="price">0.00 â‚¬</div>
            <div class="actions">
              <button class="btn primary" onclick="addToCart('p2')">AÃ±adir a la cesta</button>
              <button class="btn ghost" onclick="openProductModal('p2')">Ver mÃ¡s</button>
            </div>
          </div>
        </article>

        <article class="card" data-id="p3" data-name="Lorem Ipsum">
          <div class="thumb"><img src="https://via.placeholder.com/1200x800.png?text=Lorem+Ipsum+2" alt="Lorem Ipsum"></div>
          <div class="meta">
            <h3>Lorem Ipsum</h3>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce id justo non lorem efficitur.</p>
            <div class="price">0.00 â‚¬</div>
            <div class="actions">
              <button class="btn primary" onclick="addToCart('p3')">AÃ±adir a la cesta</button>
              <button class="btn ghost" onclick="openProductModal('p3')">Ver mÃ¡s</button>
            </div>
          </div>
        </article>

        <article class="card" data-id="p4" data-name="Lorem Ipsum">
          <div class="thumb"><img src="https://via.placeholder.com/1200x800.png?text=Lorem+Ipsum+3" alt="Lorem Ipsum"></div>
          <div class="meta">
            <h3>Lorem Ipsum</h3>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non urna vitae lectus fringilla.</p>
            <div class="price">0.00 â‚¬</div>
            <div class="actions">
              <button class="btn primary" onclick="addToCart('p4')">AÃ±adir a la cesta</button>
              <button class="btn ghost" onclick="openProductModal('p4')">Ver mÃ¡s</button>
            </div>
          </div>
        </article>

      </section>
    </div>

    <!-- SIDEBAR CART -->
    <aside class="sidebar">
      <div class="card">
        <div class="cart-header">
          <div style="font-weight:800;color:#4b2f33">Tu pedido</div>
          <div style="color:#b45f6a;font-weight:700" id="miniTotal">0.00 â‚¬</div>
        </div>

        <div class="cart-list" id="cartList">
          <div style="color:#7b6166;font-size:13px;">AÃ±ade algo a la cesta para empezar tu pedido.</div>
        </div>

        <div class="total-row">
          <div>Total</div>
          <div id="cartTotal">0.00 â‚¬</div>
        </div>

        <div class="checkout-buttons">
          <button class="btn ghost" id="clearBtn">Vaciar cesta</button>
          <button class="btn primary" id="checkoutBtn" onclick="openCheckoutForm()">Hacer pedido</button>
        </div>
      </div>
    </aside>
  </main>

  <!-- PRODUCT MODAL (detalle) -->
  <div id="productOverlay" class="overlay" onclick="overlayClick(event)">
    <div class="modal" role="dialog" aria-modal="true" aria-hidden="true">
      <div class="photo">
        <img id="modalImg" src="" alt="Foto producto">
      </div>
      <div class="info" style="position:relative;">
        <div class="close-x" onclick="closeProductModal()" aria-label="Cerrar">âœ•</div>
        <h3 id="modalTitle">TÃ­tulo</h3>
        <p id="modalShort" style="color:var(--muted);"></p>
        <p id="modalLong" style="margin-top:10px;color:#5a3f43;"></p>

        <div style="margin-top:12px;">
          <strong>Ingredientes</strong>
          <p id="modalIngredients" style="color:#6b4f56;font-size:13px;margin-top:6px;"></p>

          <strong style="display:block;margin-top:8px;">AlÃ©rgenos</strong>
          <p id="modalAllergens" style="color:#6b4f56;font-size:13px;margin-top:6px;"></p>
        </div>

        <div style="margin-top:14px;display:flex;gap:10px;">
          <button class="btn primary" id="modalAddBtn">AÃ±adir a la cesta</button>
          <button class="btn ghost" onclick="closeProductModal()">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- CHECKOUT FORM MODAL -->
  <div id="checkoutOverlay" class="overlay" onclick="overlayClick(event)">
    <div class="form-modal" role="dialog" aria-modal="true" aria-hidden="true" style="position:relative;">
      <div class="close-x" onclick="closeCheckout()" aria-label="Cerrar">âœ•</div>
      <h4>Finalizar pedido</h4>
      <div style="font-size:13px;color:var(--muted);margin-bottom:10px;">Rellena los datos para que podamos preparar tu pedido.</div>

      <div class="form-row">
        <div class="col">
          <label style="font-size:13px;color:#6b4f56">Nombre (obligatorio)</label>
          <input type="text" id="custName" placeholder="Ej. Ana PÃ©rez">
        </div>
      </div>

      <div class="form-row">
        <div class="col">
          <label style="font-size:13px;color:#6b4f56">Recogida / EnvÃ­o</label>
          <select id="deliverySelect">
            <option value="pickup">Recoger en Olalde Kalea</option>
            <option value="delivery">EnvÃ­o a domicilio (+3.00â‚¬)</option>
          </select>
        </div>
        <div class="col address-field" id="addressBlock">
          <label style="font-size:13px;color:#6b4f56">DirecciÃ³n (si envÃ­o)</label>
          <input type="text" id="addressField" placeholder="Calle, nÃºmero, piso...">
        </div>
      </div>

      <div class="form-row" style="margin-top:8px;">
        <div class="col">
          <label style="font-size:13px;color:#6b4f56">Correo electrÃ³nico (obligatorio)</label>
          <input type="email" id="emailField" placeholder="correo@ejemplo.com">
        </div>
        <div class="col">
          <label style="font-size:13px;color:#6b4f56">TelÃ©fono (obligatorio)</label>
          <input type="tel" id="phoneField" placeholder="600 000 000">
        </div>
      </div>

      <div style="margin-top:8px;">
        <label style="font-size:13px;color:#6b4f56">Nota (opcional)</label>
        <textarea id="noteField" placeholder="Algo que debamos saber..."></textarea>
      </div>

      <div style="margin-top:8px;">
        <label style="font-size:13px;color:#6b4f56">CÃ³digo descuento (opcional)</label>
        <input type="text" id="discountField" placeholder="CUPON123">
      </div>

      <div style="margin-top:12px; display:flex; gap:8px; justify-content:flex-end;">
        <button class="btn ghost" onclick="closeCheckout()">Volver</button>
        <button class="btn primary" onclick="checkout()">Confirmar y copiar pedido</button>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer style="margin-top:36px;padding:28px 16px;text-align:center;background:linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.4));">
    <div style="font-weight:700;color:#7a4950">Sweet Saborium of Saborium.</div>
    <div style="margin-top:6px;color:var(--muted);font-size:13px">Â© 2025 Todos los derechos reservados.</div>
    <div style="margin-top:8px;font-size:13px;color:#b45f6a">
      <a href="#" style="color:inherit">Condiciones de servicio</a> Â· <a href="#" style="color:inherit">PolÃ­tica de privacidad</a>
    </div>
  </footer>

  <script>
    /* ===== DATA ===== */
    const products = {
      p1: {
        id:'p1', name:'Nuestra Tarta',
        short:'La original de Sweet Saborium: cremosa por dentro y ligeramente tostada por fuera.',
        long:'Nuestra tarta de queso al horno, receta tradicional y lentamente horneada para una textura sedosa. Ideal para compartir o como pieza estrella.',
        ingredients:'Queso crema, huevos, azÃºcar, nata, base de galleta (mantequilla).',
        allergens:'Contiene: leche, huevo, gluten (base).',
        price: '0.00',
        img: 'https://via.placeholder.com/1200x800.png?text=Nuestra+Tarta'
      },
      p2: {
        id:'p2', name:'Lorem Ipsum', short:'Lorem ipsum dolor sit amet.',
        long:'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam non lorem vel magna cursus gravida.',
        ingredients:'(Ingredientes demo)',
        allergens:'(AlÃ©rgenos demo)',
        price:'0.00',
        img: 'https://via.placeholder.com/1200x800.png?text=Lorem+Ipsum+1'
      },
      p3: {
        id:'p3', name:'Lorem Ipsum', short:'Lorem ipsum dolor sit amet.',
        long:'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse potenti.',
        ingredients:'(Ingredientes demo)',
        allergens:'(AlÃ©rgenos demo)',
        price:'0.00',
        img: 'https://via.placeholder.com/1200x800.png?text=Lorem+Ipsum+2'
      },
      p4: {
        id:'p4', name:'Lorem Ipsum', short:'Lorem ipsum dolor sit amet.',
        long:'Lorem ipsum dolor sit amet, consectetur adipiscing elit.',
        ingredients:'(Ingredientes demo)',
        allergens:'(AlÃ©rgenos demo)',
        price:'0.00',
        img: 'https://via.placeholder.com/1200x800.png?text=Lorem+Ipsum+3'
      }
    };

    /* ===== CART ===== */
    let cart = {}; // {id: qty}
    const cartCountEl = document.getElementById('cartCount');
    const cartListEl = document.getElementById('cartList');
    const cartTotalEl = document.getElementById('cartTotal');
    const miniTotalEl = document.getElementById('miniTotal');

    function renderCart(){
      const entries = Object.entries(cart);
      const totalQty = entries.reduce((s,[_,q])=>s+q,0);
      cartCountEl.textContent = totalQty;
      if(entries.length===0){
        cartListEl.innerHTML = '<div style="color:#7b6166;font-size:13px;">AÃ±ade algo a la cesta para empezar tu pedido.</div>';
        cartTotalEl.textContent = '0.00 â‚¬';
        miniTotalEl.textContent = '0.00 â‚¬';
        return;
      }
      cartListEl.innerHTML = '';
      let total = 0;
      entries.forEach(([id,qty])=>{
        const p = products[id];
        total += 0.00 * qty;
        const div = document.createElement('div');
        div.className = 'cart-item';
        div.innerHTML = `
          <div class="info">
            <div class="name">${p.name}</div>
            <div style="font-size:13px;color:var(--muted)">${qty} Ã— ${p.price} â‚¬</div>
          </div>
          <div class="controls">
            <button class="small-btn" onclick="changeQty('${id}', ${qty-1})">âˆ’</button>
            <div style="min-width:24px;text-align:center;font-weight:700">${qty}</div>
            <button class="small-btn" onclick="changeQty('${id}', ${qty+1})">+</button>
          </div>
        `;
        cartListEl.appendChild(div);
      });
      cartTotalEl.textContent = (total).toFixed(2) + ' â‚¬';
      miniTotalEl.textContent = (total).toFixed(2) + ' â‚¬';
    }

    function changeQty(id, qty){
      if(qty <= 0) delete cart[id];
      else cart[id] = qty;
      renderCart();
    }

    function addToCart(id){
      if(!cart[id]) cart[id]=0;
      cart[id] += 1;
      // micro animation
      const card = document.querySelector('[data-id="'+id+'"]');
      if(card) card.animate([{transform:'scale(1)'},{transform:'scale(1.03)'},{transform:'scale(1)'}], {duration:220});
      renderCart();
    }

    // clear button
    document.getElementById('clearBtn').addEventListener('click', ()=>{
      cart = {};
      renderCart();
    });

    // toggle cart: scroll to sidebar
    function toggleCart(){
      document.querySelector('.sidebar').scrollIntoView({behavior:'smooth', block:'center'});
    }

    // initial render
    renderCart();

    /* ===== PRODUCT MODAL ===== */
    const productOverlay = document.getElementById('productOverlay');
    const modalImg = document.getElementById('modalImg');
    const modalTitle = document.getElementById('modalTitle');
    const modalShort = document.getElementById('modalShort');
    const modalLong = document.getElementById('modalLong');
    const modalIngredients = document.getElementById('modalIngredients');
    const modalAllergens = document.getElementById('modalAllergens');
    const modalAddBtn = document.getElementById('modalAddBtn');

    function openProductModal(id){
      const p = products[id];
      modalImg.src = p.img;
      modalTitle.textContent = p.name;
      modalShort.textContent = p.short;
      modalLong.textContent = p.long;
      modalIngredients.textContent = p.ingredients || 'â€”';
      modalAllergens.textContent = p.allergens || 'â€”';
      modalAddBtn.onclick = ()=>{ addToCart(id); closeProductModal(); };
      productOverlay.classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    function closeProductModal(){
      productOverlay.classList.remove('active');
      document.body.style.overflow = '';
    }
    function overlayClick(e){
      if(e.target === productOverlay || e.target === checkoutOverlay) {
        closeProductModal();
        closeCheckout();
      }
    }

    /* ===== CHECKOUT FORM LOGIC ===== */
    const checkoutOverlay = document.getElementById('checkoutOverlay');
    const deliverySelect = document.getElementById('deliverySelect');
    const addressBlock = document.getElementById('addressBlock');

    deliverySelect.addEventListener('change', (e)=>{
      if(e.target.value === 'delivery'){
        // open address with animation
        addressBlock.classList.add('open');
      } else {
        addressBlock.classList.remove('open');
      }
    });

    function openCheckoutForm(){
      // require at least 1 item
      if(Object.keys(cart).length === 0){ alert('Tu cesta estÃ¡ vacÃ­a. AÃ±ade algo antes de hacer un pedido.'); return; }
      checkoutOverlay.classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    function closeCheckout(){
      checkoutOverlay.classList.remove('active');
      document.body.style.overflow = '';
    }

    function buildOrderText(){
      const name = document.getElementById('custName').value.trim() || '[Nombre]';
      const method = document.getElementById('deliverySelect').value;
      const address = document.getElementById('addressField').value.trim() || (method==='delivery' ? '[DirecciÃ³n]' : 'Olalde Kalea');
      const email = document.getElementById('emailField').value.trim() || '[email]';
      const phone = document.getElementById('phoneField').value.trim() || '[tel]';
      const note = document.getElementById('noteField').value.trim() || '';
      const discount = document.getElementById('discountField').value.trim() || '';

      const entries = Object.entries(cart);
      let lines = [];
      if(entries.length===0) lines.push('--- SIN ITEMS EN LA CESTA ---');
      else {
        lines.push('Pedido:');
        entries.forEach(([id,qty])=>{
          const p = products[id];
          lines.push(`- ${p.name} x${qty} (precio: ${p.price} â‚¬)`);
        });
      }

      const deliveryCharge = (method === 'delivery') ? 3.00 : 0.00;
      const subtotal = 0.00;
      const total = (subtotal + deliveryCharge).toFixed(2);

      const text = `SWEET SABORIUM - Pedido automÃ¡tico

Nombre: ${name}
Recogida/EnvÃ­o: ${method === 'pickup' ? 'Recoger en Olalde Kalea' : 'EnvÃ­o a domicilio (+3.00â‚¬)'}
DirecciÃ³n: ${address}
Email: ${email}
TelÃ©fono: ${phone}

${lines.join('\n')}

Nota cliente: ${note}
CÃ³digo descuento: ${discount}

Subtotal: ${subtotal.toFixed(2)} â‚¬
Gastos envÃ­o: ${deliveryCharge.toFixed(2)} â‚¬
TOTAL: ${total} â‚¬

MÃ©todos de pago: efectivo por adelantado o Bizum al 644677582

(Se recomienda pegar este texto en el formulario de Google Forms con CTRL+V / pegar)
`;
      return text;
    }

    async function checkout(){
      // VALIDATIONS
      const name = document.getElementById('custName').value.trim();
      const email = document.getElementById('emailField').value.trim();
      const phone = document.getElementById('phoneField').value.trim();
      const method = document.getElementById('deliverySelect').value;
      const address = document.getElementById('addressField').value.trim();

      if(!name){ alert('Por favor indica tu nombre.'); document.getElementById('custName').focus(); return; }
      if(!email || !validateEmail(email)){ alert('Por favor indica un correo electrÃ³nico vÃ¡lido.'); document.getElementById('emailField').focus(); return; }
      if(!phone){ alert('Por favor indica un nÃºmero de telÃ©fono.'); document.getElementById('phoneField').focus(); return; }
      if(method === 'delivery' && !address){ alert('Has seleccionado envÃ­o a domicilio; por favor indica la direcciÃ³n.'); document.getElementById('addressField').focus(); return; }

      const orderText = buildOrderText();
      try {
        await navigator.clipboard.writeText(orderText);
        // small success feedback
        alert('Tu pedido se ha copiado al portapapeles. SerÃ¡s redirigido al formulario de pedido.');
      } catch(e){
        // fallback
        prompt('No se pudo copiar automÃ¡ticamente. Selecciona y copia este texto (Ctrl+C):', orderText);
      }

      // replace this with your Google Form URL
      const googleFormURL = 'https://forms.gle/your-google-form-id';

      // Redirect after 1 second
      setTimeout(()=> { window.location.href = googleFormURL; }, 1000);
    }

    function validateEmail(email){
      // simple regex
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }

    /* ===== OPEN COVER -> ENTER ===== */
    document.getElementById('enterBtn').addEventListener('click', ()=>{
      // fade out cover and show main
      const cover = document.getElementById('cover');
      cover.style.transition = 'opacity .6s ease, transform .6s ease';
      cover.style.opacity = '0';
      cover.style.transform = 'translateY(-12px)';
      setTimeout(()=> { cover.style.display = 'none'; document.getElementById('mainContent').style.opacity='1'; document.getElementById('mainContent').style.transform='translateY(0)'; window.scrollTo({top:0,behavior:'smooth'}); }, 650);
    });

    // small utility: attach openProduct modal for each 'Ver mÃ¡s' button based on data-id
    document.querySelectorAll('[data-id]').forEach(el=>{
      const id = el.getAttribute('data-id');
      // attach the buttons already have onclicks; nothing else needed
    });

    // Close overlays when pressing Escape
    document.addEventListener('keydown', (e)=>{
      if(e.key === 'Escape'){
        closeProductModal();
        closeCheckout();
      }
    });

    // Ensure address block initial state
    if(deliverySelect.value === 'delivery') addressBlock.classList.add('open');

  </script>
</body>
</html>
